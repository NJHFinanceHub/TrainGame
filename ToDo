# SNOWPIERCER: ETERNAL ENGINE â€” Master TODO

> **Repo:** NJHFinanceHub/TrainGame
> **Engine:** Unreal Engine 5.7.3, C++
> **Priority:** P0 (blocks everything), P1 (core gameplay), P2 (important), P3 (polish)
> **Status:** âœ… = Done, ðŸ”¨ = In Progress, â¬œ = Not Started

---

## LAUNCH BLOCKERS â€” Must Fix Before Ship ðŸš¨

> These items were identified from the current demo and must be resolved.

- â¬œ **NO SOUND** â€” Demo is completely silent. Sound design is now P1 (see Phase 7)
- â¬œ **CAR SCALE** â€” Cars are ~10x too small. Train should feel MASSIVE. Rework all car geometry
- â¬œ **NO CHARACTERS** â€” No player model, no NPCs, no companions visible. Need at minimum:
  - â¬œ Player character model (protagonist) â€” visible in 3rd person
  - â¬œ Basic NPC models per zone (crowd, workers, guards, civilians)
  - â¬œ Jackboot guard models (primary antagonist NPCs)
  - â¬œ Companion character models (at least first 2-3 recruitable)
  - â¬œ Character animations (idle, walk, run, combat, interact)
- â¬œ **NO DATATABLES** â€” C++ systems exist but zero game data (items, quests, dialogue, collectibles)
- â¬œ **NO PICKUP/NPC BLUEPRINTS** â€” No placeable actors to put items or NPCs in the world
- â¬œ **LOWER TRANSPORT DECK** â€” Second layer beneath 3rd-1st Class with mini-rail (see Phase 4.1b)
- â¬œ **ORPHANED CODE** â€” ~6000 lines in Source/SnowyEngine + Source/TrainGame not compiled

---

## PHASE 1: DESIGN (COMPLETE)
All design documents completed. See `/docs/`, `/design/`, `/narrative/` directories.
- âœ… Protagonist definition, backstory, stats
- âœ… Character progression system (6 attributes, 5 skill trees, perks)
- âœ… Companion roster (12 companions across all zones)
- âœ… Dialogue system architecture (branching + skill checks)
- âœ… Economy & crafting (13 resource types, 50+ recipes, 5 tiers)
- âœ… Stealth & disguise system design
- âœ… Exploration & secrets (200+ collectibles, 9 secret cars)
- âœ… World lore (timeline, freeze history, demographics)
- âœ… Narrative: antagonists, 30+ named NPCs, 20+ moral choices, 6 endings
- âœ… Audio direction, UI/HUD design, difficulty settings
- âœ… Technical specs (streaming, save system, performance budgets)
- âœ… Steam/publishing plan, accessibility, mod support

---

## PHASE 2: FOUNDATION (COMPLETE)
- âœ… UE5 project structure (SnowpiercerEE module)
- âœ… Compile on UE 5.7.3 â€” all headers, macros, API fixes
- âœ… Config files (DefaultEngine, DefaultGame, DefaultInput)
- âœ… GameMode + PlayerController + SEECharacter
- âœ… Car streaming subsystem (USEECarStreamingSubsystem)
- âœ… Save/load subsystem (USEESaveGameSubsystem)
- âœ… Exploration components (Collectible, Journal, Crawlspace, Exterior, Window, SecretCar)
- âœ… Train movement component (sway, sound)
- âœ… Asset import pipeline (200 art assets, PBR materials)
- âœ… Demo level scripts (single car + 100-car train)
- âœ… Repo cleanup â€” all assets organized under Assets/

---

## PHASE 3: CORE SYSTEMS (COMPLETE)

### 3.1 Player Character â€” âœ…
- âœ… ASEECharacter: movement, sprint, run, crouch, jump
- âœ… First/third person camera toggle (V key)
- âœ… Stamina system (drain on run/sprint, regen with delay)
- âœ… Interaction system (line trace, collectible activation)
- âœ… USEEHealthComponent â€” HP, 7 damage types, 5 injury types, downed/revive, armor
- âœ… USEEHungerComponent â€” gradual drain, stamina penalties, starvation damage
- âœ… USEEColdComponent â€” temperature model, 4 frostbite stages, cold suit bonus
- âœ… USEEStatsComponent â€” 6 attributes (STR/AGI/END/CUN/PER/CHA), XP/leveling, skill checks
- âœ… All components wired to character, input bindings set
- â¬œ **Skill trees** â€” 5 trees, 8+ nodes each (code architecture exists, no tree data)
- â¬œ **Perk system** â€” passive bonuses at level thresholds
- â¬œ **Climbing/mantling** â€” contextual, ladders, pipes, stacked bunks
- â¬œ **Swimming** â€” for aquarium/flood sections

### 3.2 NPC System â€” Partial âœ…
- âœ… ASEENPCCharacter: base class with states, patrol, detection, combat
- âœ… Sight + hearing detection model
- âœ… Patrol system (waypoint-based, ping-pong)
- â¬œ **AI Controller** â€” full behavior tree (UBehaviorTree + UBlackboardData)
- â¬œ **NPC schedules** â€” time-of-day routines
- â¬œ **NPC spawner** â€” data-driven NPC placement per car
- â¬œ **Crowd NPCs** â€” lightweight ambient NPCs
- â¬œ **Jackboot AI** â€” alert propagation, backup calling, formation combat
- â¬œ **Companion AI** â€” follow player, combat support, hold position

### 3.3 Combat System â€” âœ…
- âœ… USEECombatComponent â€” light/heavy attacks, 3-hit combo, block (70% reduction), parry (0.2s window), dodge with i-frames
- âœ… ASEEWeaponBase â€” 5 weapon tiers, damage/speed/range/weight/durability stats
- âœ… Weapon trace via SweepMultiByChannel
- âœ… Strength modifier from StatsComponent, injury modifier from HealthComponent
- â¬œ **Ranged combat** â€” crossbow, thrown objects, improvised firearms
- â¬œ **Environmental kills** â€” steam vents, electrical panels, window breaches
- â¬œ **Stealth takedowns** â€” grab from behind, chokehold, knockout
- â¬œ **Kronole combat mode** â€” slow-motion perception
- â¬œ **Enemy variety** â€” 4+ enemy types with unique behaviors
- â¬œ **Boss fights** â€” 7 zone bosses with unique mechanics

### 3.4 Inventory & Crafting â€” Partial âœ…
- âœ… USEEInventoryComponent â€” 30 slots, weight limit (50+STRÃ—5), stacking, quick slots 0-3
- âœ… FSEEItemData (FTableRowBase) â€” categories (Weapon/Armor/Consumable/Crafting/Quest/Junk)
- âœ… Consumable use (heals HP)
- â¬œ **Item DataTable** â€” P0, BLOCKS GAMEPLAY: no items defined yet
- â¬œ **Pickup actors** â€” world items, lootable containers
- â¬œ **Crafting stations** â€” 6 types per design
- â¬œ **Recipe DataTable** â€” data table driven crafting
- â¬œ **Equipment slots** â€” weapon, head, torso, legs, hands, accessory

### 3.5 Dialogue System â€” âœ… (code only)
- âœ… USEEDialogueManager (GameInstanceSubsystem) â€” FSEEDialogueNode, 6 node types, conversation flags
- âœ… USEEQuestManager (GameInstanceSubsystem) â€” objectives, prerequisites, auto-completion
- âœ… USEEFactionManager (GameInstanceSubsystem) â€” 8 factions, rep tracking, mutual exclusivity
- â¬œ **Dialogue DataTable** â€” P0: no dialogue trees authored
- â¬œ **Quest DataTable** â€” P0: no quests defined
- â¬œ **Dialogue UI** â€” speaker portrait, text, response options
- â¬œ **Bark system** â€” ambient NPC lines
- â¬œ **PA system** â€” train announcements per zone

### 3.6 HUD â€” âœ…
- âœ… ASEEHUD â€” canvas-drawn health/stamina bars, hunger/cold indicators, crosshair, damage direction, weapon durability, injury text

---

## PHASE 4: PLAYABLE DEMO â€” P0 ðŸ”¨

> **Goal:** Make Zone 1 (Cars 0-14) fully playable as a standalone demo.
> This is what separates "code framework" from "game."

### 4.0 CRITICAL BLOCKERS â€” Must fix before anything else
- â¬œ **SCALE REWORK** â€” increase all car dimensions ~10x from current demo size â€” P0
  > Demo cars are WAY too small. This train is MASSIVE â€” think aircraft carrier
  > on rails. Each car should feel like a building interior, not a closet.
- â¬œ **Create Item DataTable** (DT_Items) â€” 20+ items: food, medicine, weapons, crafting materials, quest items
- â¬œ **Create Weapon DataTable** â€” stats for 8-10 weapons across 5 tiers
- â¬œ **Create Quest DataTable** â€” Zone 1 main quest + 5 side quests
- â¬œ **Create Dialogue DataTable** â€” 5-10 NPC conversation trees for Zone 1
- â¬œ **Create Collectible DataTable** â€” 20+ collectibles for Zone 1
- â¬œ **Create Faction seed data** â€” starting rep values for 8 factions
- â¬œ **Pickup actor Blueprint** â€” world-placeable item that calls AddItem on interact
- â¬œ **NPC Blueprint** â€” placeable NPC with dialogue trigger

### 4.1 One-Click Demo â€” âœ…
- âœ… launch_demo.py â€” single script imports assets, builds level, sets startup map
- âœ… import_assets.py â€” batch asset import with PBR classification
- âœ… setup_demo_level.py â€” builds DevTestCar with geometry, lights, actors
- âœ… rebuild_demo_level.py â€” procedural 100-car train generation

### 4.1b Lower Transport Layer â€” P1
> Below the main passenger level (Third Class through First Class), there is a
> second lower deck used for cargo transport. Has its own mini-rail system for
> moving goods between zones. Accessible via hatches/stairs from above.

- â¬œ **Lower deck geometry** â€” runs beneath cars 15-82 (Third through First Class)
- â¬œ **Mini-rail system** â€” small rail carts for cargo transport between zones
- â¬œ **Cargo types** â€” food crates, medical supplies, luxury goods, contraband
- â¬œ **Access points** â€” hatches, freight elevators, maintenance stairs from upper level
- â¬œ **Stealth route** â€” player can use lower deck to bypass checkpoints/guards
- â¬œ **Smuggling gameplay** â€” Kronole Network runs contraband through lower deck
- â¬œ **Environmental design** â€” industrial, dim lighting, cramped but functional
- â¬œ **Mini-rail mechanics** â€” ride carts, switch tracks, avoid automated security

### 4.2 Character & Animation â€” P0
- â¬œ **Player mesh** â€” skeletal mesh (Mannequin placeholder or custom)
- â¬œ **Animation Blueprint** â€” idle, walk, run, sprint, crouch, jump, attack, block, dodge, death
- â¬œ **Weapon socket** â€” "weapon_r" socket on skeleton, weapon attach
- â¬œ **Hit reactions** â€” stagger, knockback, death ragdoll
- â¬œ **NPC mesh** â€” at least 2 variants (Jackboot, Civilian)
- â¬œ **NPC animation** â€” patrol walk, idle, combat stance, death

### 4.3 Materials & Lighting â€” P1
- â¬œ **Persist materials as .uasset** â€” currently only exist after running Python script
- â¬œ **Zone-specific lighting profiles** â€” Tail (dark, flickering), other zones later
- â¬œ **Post-process volume** â€” grime, film grain for Tail atmosphere

### 4.4 Zone 1: Tail (Cars 0-14) â€” P1
- â¬œ Car 0: Caboose â€” sealed rear, memorials, tutorial movement
- â¬œ Car 1-2: Tail Quarters â€” cramped bunks, NPC introductions
- â¬œ Car 3: The Pit â€” combat tutorial arena
- â¬œ Car 4: Nursery â€” first moral choice (children's rations)
- â¬œ Car 5: Elders' Car â€” quest hub, first companion recruitment
- â¬œ Car 6: Sickbay â€” medicine resource introduction
- â¬œ Car 7: Workshop â€” crafting tutorial
- â¬œ Car 8: Listening Post â€” lore/intel gathering
- â¬œ Car 9: Blockade â€” first real combat encounter (8-10 Jackboots)
- â¬œ Car 10: Dark Car â€” horror/stealth section
- â¬œ Car 11: Freezer Breach â€” cold damage timer
- â¬œ Car 12: Kronole Den â€” drug system introduction
- â¬œ Car 13: Smuggler's Cache â€” trading system unlock
- â¬œ Car 14: Martyr's Gate â€” BOSS: Jackboot Commander

### 4.5 Orphaned Code Decision â€” P1
- â¬œ **Consolidate Source/SnowyEngine + Source/TrainGame into SnowpiercerEE** â€” ~6000 lines of code (stealth, companions, crafting, economy, Kronole, Slate UI widgets) exist but are NOT registered in .uproject and never compile. Decide: migrate useful code into SnowpiercerEE module OR register these as additional modules.

---

## PHASE 5: FACTION & QUEST SYSTEM â€” P1

### 5.1 Faction System
- âœ… USEEFactionManager â€” 8 factions, -100/+100 rep, standings, mutual exclusivity
- â¬œ **Faction UI** â€” reputation bars, standing labels
- â¬œ **Faction consequences** â€” access, prices, dialogue, aggression
- â¬œ **Faction quests** â€” 5-8 quests per faction

### 5.2 Quest System
- âœ… USEEQuestManager â€” active/completed/failed, objectives, prerequisites
- â¬œ **Quest data** â€” main quest + 50+ side quests
- â¬œ **Quest UI** â€” log, tracking, map markers
- â¬œ **Companion quests** â€” 3-5 per companion (~48 total)

### 5.3 Moral Choice System
- â¬œ **24+ major choices** â€” each affects faction rep + companion loyalty + ending path
- â¬œ **Choice consequence tracking** â€” flags in save system
- â¬œ **Compound consequences** â€” late choices reference early ones

---

## PHASE 6: UI/HUD â€” P1

- âœ… ASEEHUD â€” canvas-drawn bars, indicators, crosshair, damage direction
- â¬œ **Train map** â€” 100-car linear diagram, scrollable, zone colors, fog of war
- â¬œ **Inventory screen** â€” grid + weight, sorting, comparison (UMG widget)
- â¬œ **Character screen** â€” stats, skills, perks, equipment
- â¬œ **Quest log** â€” active/completed/failed, tracking toggle
- â¬œ **Faction screen** â€” reputation bars
- â¬œ **Companion screen** â€” loyalty, equipment, personal quest
- â¬œ **Crafting screen** â€” recipes, materials, station requirements
- â¬œ **Codex/journal** â€” lore, collectibles tracker
- â¬œ **Dialogue UI** â€” speaker portrait, text, response options
- â¬œ **Main menu** â€” new game, continue, settings, credits
- â¬œ **Pause menu** â€” resume, save, load, settings, quit
- â¬œ **Death screen** â€” reload checkpoint / quit

---

## PHASE 7: AUDIO & VFX â€” P1 ðŸ”¨

> **NOTE:** Demo currently has NO sound. This is a top priority for launch.
> Each zone has a distinct sonic identity reflecting its culture and class.
> 2 audio files imported so far: train_interior.mp3, train_whistle.mp3

### 7.1 Zone Sound Design â€” Sonic Identity Per Class

#### Tail (Cars 0-14) â€” Raw, Industrial, Desperate
- â¬œ **Base layer** â€” bumpy train rhythm, rattling metal, loose bolts, uneven track noise
- â¬œ **Ambient** â€” dripping water, distant coughing, hushed voices, crying children
- â¬œ **Wind** â€” howling/whooshing wind through hull breaches and thin walls
- â¬œ **Music** â€” sparse, percussive, improvised instruments (banging pipes, rhythmic chanting)
- â¬œ **Creaking** â€” constant structural stress sounds, the train fighting to hold together

#### Third Class (Cars 15-29) â€” Techno-Punk, Blue Collar Energy
- â¬œ **Base layer** â€” heavy machinery hum, rhythmic piston sounds, steam releases
- â¬œ **Ambient** â€” factory noise, welding sparks, tools clanking, work chatter
- â¬œ **Music** â€” techno-punk/industrial beats, gritty electronic rhythms, worker anthems
- â¬œ **Crowd** â€” boisterous workers, arguments, laughing in mess hall, union rallying
- â¬œ **Shift horns** â€” industrial buzzers marking shift changes

#### Second Class (Cars 30-49) â€” Calm, Refined, Comfortable
- â¬œ **Base layer** â€” smooth train movement, barely perceptible sway, dampened track noise
- â¬œ **Ambient** â€” soft conversation, children playing, pages turning, gentle clinking of glasses
- â¬œ **Music** â€” calm ambient piano, soft jazz, acoustic guitar, relaxing lounge music
- â¬œ **Atmosphere** â€” families at dinner, teachers lecturing, quiet wealth, muted sophistication
- â¬œ **Nature sounds** â€” greenhouse/garden cars have birds, trickling water, leaf rustling

#### First Class (Cars 63-82) â€” Full Orchestra, Live Music, Opulence
- â¬œ **Base layer** â€” near-silent train (premium sound dampening), pristine mechanical hum
- â¬œ **Live Music Car** â€” dedicated car with live orchestra/chamber ensemble performing
- â¬œ **Music** â€” full symphonic scores, classical compositions, opera arias, grand waltzes
- â¬œ **Ambient** â€” champagne glasses clinking, formal laughter, rustling silk, fine dining
- â¬œ **Ballroom** â€” sweeping waltz music, echoing grand hall acoustics
- â¬œ **Casino** â€” jazz combo, chips clicking, slot machine chimes
- â¬œ **Opera House** â€” full vocal performances, dramatic scores, audience whispers

#### Working Spine (Cars 50-62) â€” Functional, Mechanical, Clean
- â¬œ **Base layer** â€” powerful generator hum, clean turbine whir, precise mechanical rhythm
- â¬œ **Ambient** â€” pressurized air systems, computer terminals beeping, flow meters
- â¬œ **Music** â€” minimal electronic, functional tones, system-status audio cues
- â¬œ **Character** â€” functional but polished, like a well-maintained submarine

#### Sanctum (Cars 83-95) â€” Sacred, Unsettling, Reverberant
- â¬œ **Base layer** â€” deep resonant hum, almost subliminal bass drone
- â¬œ **Ambient** â€” choral chanting, incense crackling, echoing footsteps on marble
- â¬œ **Music** â€” pipe organ, religious choir, ethereal/disturbing hymns
- â¬œ **Tension** â€” subtle dissonance, heartbeat-like pulses in experimental cars

#### Engine (Cars 96-99) â€” Mechanical Cathedral, Clean Power
- â¬œ **Base layer** â€” the Engine's rhythmic heartbeat, powerful and steady
- â¬œ **Ambient** â€” pristine mechanical precision, cool air systems, quiet authority
- â¬œ **Music** â€” grand but restrained, the Engine's rhythm IS the music
- â¬œ **Character** â€” functional and clean, high-tech, imposing without being dirty

### 7.2 Cross-Zone Audio Systems
- â¬œ **Adaptive music** â€” exploration â†’ suspicion â†’ combat â†’ wind-down (per zone)
- â¬œ **Zone crossfade** â€” seamless sonic transitions as player moves between zones
- â¬œ **7 boss fight themes** â€” each reflecting the zone's sonic identity
- â¬œ **Combat SFX** â€” weapon impacts per type, armor clanks, grunts, contextual to zone
- â¬œ **Environmental SFX** â€” doors, pressure seals, hull breach, machinery
- â¬œ **UI SFX** â€” pickup, quest update, level up, menu navigation
- â¬œ **PA system** â€” zone-specific announcements (looping, tone shifts per class)
- â¬œ **Train constant** â€” underlying train movement sound present everywhere, quality varies by zone
- â¬œ **Dynamic wind** â€” wind intensity changes with hull integrity, exterior sections, speed

### 7.3 VFX
- âœ… **Steam/smoke** â€” SteamVentVFXComponent: Niagara-based, continuous/burst/intermittent modes
- âœ… **Sparks** â€” SparkVFXComponent: ambient periodic + on-demand burst, light flash
- âœ… **Cold breath** â€” ColdBreathVFXComponent: breath-synced puffs, exertion scaling
- âœ… **Blood/damage** â€” CombatVFXComponent: hit impacts, blood splatter, decals, block sparks
- âœ… **Kronole effects** â€” KronoleVFXComponent: post-process distortion, chromatic aberration, motes
- âœ… **Weather through windows** â€” WeatherWindowComponent: blizzard/aurora/clear/white-out/night
- âœ… **Lighting flickers** â€” LightFlickerComponent: occasional/nervous/dying/strobing patterns
- âœ… **Zone VFX profiles** â€” ZoneVFXProfile data asset + VFXSubsystem world coordinator

---

## PHASE 8: POLISH & SYSTEMS â€” P2

### 8.1 Save System
- âœ… USEESaveGameSubsystem â€” save/load infrastructure exists
- â¬œ **Per-car state persistence** â€” NPCs, loot, doors, faction control
- â¬œ **3 manual save slots + 1 autosave**
- â¬œ **Autosave triggers** â€” car entry, quest completion, major choice

### 8.2 Difficulty
- â¬œ **4 tiers** â€” Passenger, Survivor, Eternal Engine, Mr. Wilford
- â¬œ **Per-difficulty modifiers** â€” AI aggression, resource scarcity, permadeath

### 8.3 Accessibility
- â¬œ Full subtitles with speaker ID
- â¬œ Colorblind modes (3 types)
- â¬œ Control remapping

### 8.4 Performance
- â¬œ Car streaming optimization â€” max 3 loaded
- â¬œ LOD system for distant cars
- â¬œ NPC pooling (max 20 per car)

---

## PHASE 9: ENDINGS & NARRATIVE â€” P1
- â¬œ 6 endings implementation
- â¬œ Ending calculator â€” aggregate choice flags
- â¬œ Ending cinematics

---

## PHASE 10: STEAM & PUBLISHING â€” P2
- â¬œ Steam integration (achievements, cloud saves, rich presence)
- â¬œ Store page, trailer, demo build (Cars 0-14)

---

## PHASE 11: POST-LAUNCH â€” P3
- â¬œ New Game+, roguelike mode, photo mode, mod support

---

## CURRENT SPRINT: Launch Blockers + Phase 4

> **Status:** Demo is playable but has no sound, no characters, and cars are
> too small. Extensive work remains for launch. All planned features from
> design phase must be deployed.

**Immediate Priorities (from demo feedback):**
1. Car scale rework (10x larger)
2. Sound design implementation (full zone-specific audio)
3. Character models & animations (player, NPCs, Jackboots, companions)
4. Lower transport deck with mini-rail system
5. DataTables + Blueprints (items, quests, dialogue, pickups, NPCs)
6. Orphaned code consolidation (~6000 lines to integrate)

**Previous Polecats (all need recycle):**
| Polecat | Bead | Assignment | Status |
|---------|------|------------|--------|
| rust | hq-bsztm | Player Character Systems | Shell died â€” needs recycle |
| chrome | hq-qnc2b | Combat System | Failed to start â€” needs recycle |
| guzzle | hq-b36xd | UI/HUD | Active |
| nitro | hq-t3h4m | Stealth & NPC AI | Failed to start â€” needs recycle |

**Next beads to create:**
- Car Scale Rework (P0 â€” 10x size increase)
- Sound Design: Zone Audio Identity (P1)
- Character Models & Animation (P0 â€” no characters in demo)
- Lower Transport Deck + Mini-Rail (P1)
- DataTables & Blueprints (P0 â€” items, quests, dialogue, pickups)
- Orphaned Code Consolidation (P1)
