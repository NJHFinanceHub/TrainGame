# SNOWPIERCER: ETERNAL ENGINE â€” Master TODO

> **Repo:** NJHFinanceHub/TrainGame
> **Engine:** Unreal Engine 5.7.3, C++
> **Priority:** P0 (blocks everything), P1 (core gameplay), P2 (important), P3 (polish)
> **Status:** âœ… = Done, ðŸ”¨ = In Progress, â¬œ = Not Started

---

## PHASE 1: DESIGN (COMPLETE)
All design documents completed by polecats. See `/design/` and `/narrative/` directories.
- âœ… Protagonist definition, backstory, stats
- âœ… Character progression system (6 attributes, 5 skill trees, perks)
- âœ… Companion roster (12 companions across all zones)
- âœ… Dialogue system architecture (branching + skill checks)
- âœ… Economy & crafting (13 resource types, 50+ recipes, 5 tiers)
- âœ… Stealth & disguise system design
- âœ… Exploration & secrets (200+ collectibles, 9 secret cars)
- âœ… World lore (timeline, freeze history, demographics)
- âœ… Narrative: antagonists, 30+ named NPCs, 20+ moral choices, 6 endings
- âœ… Audio direction, UI/HUD design, difficulty settings
- âœ… Technical specs (streaming, save system, performance budgets)
- âœ… Steam/publishing plan, accessibility, mod support

---

## PHASE 2: FOUNDATION (COMPLETE)
- âœ… UE5 project structure (SnowpiercerEE module)
- âœ… Compile on UE 5.7.3 â€” all headers, macros, API fixes
- âœ… Config files (DefaultEngine, DefaultGame, DefaultInput)
- âœ… GameMode + PlayerController + SEECharacter
- âœ… Car streaming subsystem (USEECarStreamingSubsystem)
- âœ… Save/load subsystem (USEESaveGameSubsystem)
- âœ… Exploration components (Collectible, Journal, Crawlspace, Exterior, Window, SecretCar)
- âœ… Train movement component (sway, sound)
- âœ… Asset import pipeline (200 art assets, PBR materials)
- âœ… Demo level scripts (100-car train, themed sections)

---

## PHASE 3: CORE SYSTEMS â€” P0 ðŸ”¨

### 3.1 Player Character â€” P0
- âœ… ASEECharacter: movement, sprint, run, crouch, jump
- âœ… First/third person camera toggle (V key)
- âœ… Stamina system (drain on run/sprint, regen with delay)
- âœ… Interaction system (line trace, collectible activation)
- â¬œ **Health system** â€” HP, damage, death, respawn at checkpoint
- â¬œ **Hunger system** â€” gradual drain, affects stamina regen
- â¬œ **Cold exposure system** â€” temperature zones, frostbite debuffs
- â¬œ **Injury system** â€” broken arm (reduced melee), leg injury (slower), persists until healed
- â¬œ **Attribute system** â€” Strength, Endurance, Cunning, Charisma, Perception, Survival
- â¬œ **XP & leveling** â€” hybrid milestone + XP, skill point allocation
- â¬œ **Skill trees** â€” Combat, Stealth, Survival, Leadership, Engineer (5 trees, 8+ nodes each)
- â¬œ **Perk system** â€” passive bonuses at level thresholds
- â¬œ **Climbing/mantling** â€” contextual, ladders, pipes, stacked bunks
- â¬œ **Vent crawling** â€” enter/exit vents, stealth bypass
- â¬œ **Swimming** â€” for aquarium/flood sections

### 3.2 NPC System â€” P0
- âœ… ASEENPCCharacter: base class with states, patrol, detection, combat
- âœ… Sight + hearing detection model
- âœ… Patrol system (waypoint-based, ping-pong)
- âœ… Ambient dialogue lines
- â¬œ **AI Controller** â€” full behavior tree (UBehaviorTree + UBlackboardData)
- â¬œ **NPC schedules** â€” time-of-day routines (sleep, work, patrol, eat)
- â¬œ **NPC spawner** â€” data-driven NPC placement per car
- â¬œ **Crowd NPCs** â€” lightweight ambient NPCs (no combat, walk/idle/talk)
- â¬œ **Jackboot AI** â€” alert propagation, backup calling, formation combat
- â¬œ **Civilian AI** â€” flee on combat, report crime, gossip
- â¬œ **Companion AI** â€” follow player, combat support, hold position mode
- â¬œ **Body discovery** â€” NPCs find unconscious/dead bodies, raise alert
- â¬œ **NPC memory** â€” remember player actions, dialogue flags

### 3.3 Combat System â€” P0
- â¬œ **Melee combat** â€” light attack, heavy attack, block, parry, dodge
- â¬œ **Hit detection** â€” weapon traces, damage calculation with armor
- â¬œ **Weapon system** â€” equippable weapons, stats, durability, degradation
- â¬œ **Ranged combat** â€” crossbow, thrown objects, improvised firearms
- â¬œ **Environmental kills** â€” steam vents, electrical panels, window breaches
- â¬œ **Stealth takedowns** â€” grab from behind, chokehold, knockout
- â¬œ **Kronole combat mode** â€” slow-motion perception, temporary buffs
- â¬œ **Enemy variety** â€” Jackboot grunt, Jackboot captain, Order zealot, First Class guard
- â¬œ **Boss fights** â€” 7 zone bosses with unique mechanics
- â¬œ **Damage types** â€” blunt, bladed, piercing, fire, cold, electric
- â¬œ **Fatigue system** â€” extended combat drains stamina

### 3.4 Inventory & Crafting â€” P0
- â¬œ **Inventory UI** â€” grid/list, weight system, sorting, filtering
- â¬œ **Item base class** â€” UObject-based with stats, icon, description, stack size
- â¬œ **Pickup actors** â€” world items, lootable containers, body looting
- â¬œ **Crafting stations** â€” 6 types per design (Improvised, Machine Shop, Chemistry, etc.)
- â¬œ **Recipe system** â€” data table driven, skill requirements, failure chance
- â¬œ **Weapon modification** â€” attachments, upgrades, damage type changes
- â¬œ **Equipment slots** â€” weapon, head, torso, legs, hands, accessory
- â¬œ **Resource degradation** â€” food spoils, chemicals decay

### 3.5 Dialogue System â€” P0
- â¬œ **Dialogue tree engine** â€” branching node graph, condition checks
- â¬œ **Dialogue UI** â€” speaker portrait, text, 4 response options
- â¬œ **Skill checks in dialogue** â€” Charisma, Cunning, Perception, Strength, Engineer
- â¬œ **NPC memory** â€” track what player said, adjust future options
- â¬œ **Timed responses** â€” silence counts as a choice
- â¬œ **Bark system** â€” ambient NPC lines, context-sensitive
- â¬œ **PA system** â€” recurring train announcements per zone
- â¬œ **Consequence flags** â€” dialogue choices set flags for quest/ending tracking

---

## PHASE 4: WORLD BUILDING â€” P1

### 4.1 Car Construction â€” P1
- â¬œ **Modular car kit** â€” wall panels, floor tiles, door frames, furniture blocks
- â¬œ **Car template system** â€” reusable layouts (barracks, workshop, lounge, etc.)
- â¬œ **100 unique car levels** â€” each as a sublevel for streaming
- â¬œ **Environmental storytelling** â€” graffiti, notes, damage, lived-in details
- â¬œ **Car transitions** â€” door opening animation as loading mask
- â¬œ **Connector corridors** â€” between-car walkways with sway
- â¬œ **Window system** â€” exterior views per zone, breakable for combat
- â¬œ **Lighting per zone** â€” Tail (dark), Third (industrial), Second (warm), First (gold), Engine (blue-white)

### 4.2 Zone: Tail (Cars 0-14) â€” P1
- â¬œ Car 0: Caboose â€” sealed rear, memorials, tutorial movement
- â¬œ Car 1-2: Tail Quarters â€” cramped bunks, NPC introductions
- â¬œ Car 3: The Pit â€” combat tutorial arena
- â¬œ Car 4: Nursery â€” first moral choice (children's rations)
- â¬œ Car 5: Elders' Car â€” quest hub, first companion recruitment
- â¬œ Car 6: Sickbay â€” medicine resource introduction
- â¬œ Car 7: Workshop â€” crafting tutorial
- â¬œ Car 8: Listening Post â€” lore/intel gathering
- â¬œ Car 9: Blockade â€” first real combat encounter (8-10 Jackboots)
- â¬œ Car 10: Dark Car â€” horror/stealth section
- â¬œ Car 11: Freezer Breach â€” cold damage timer, environmental hazard
- â¬œ Car 12: Kronole Den â€” drug system introduction
- â¬œ Car 13: Smuggler's Cache â€” trading system unlock
- â¬œ Car 14: Martyr's Gate â€” past revolution evidence + BOSS: Jackboot Commander

### 4.3 Zone: Third Class (Cars 15-29) â€” P1
- â¬œ 15 cars: Processing, Laundry, Barracks, Mess Hall, Chapel, Machine Shop, Brig, Medical, School, Hydroponics, Union Hall, Checkpoint
- â¬œ Faction introductions: Third Class Union, Kronole Network
- â¬œ Companion recruitment: Engineer, Laborer
- â¬œ Major quest: Worker strike

### 4.4 Zone: Second Class (Cars 30-49) â€” P1
- â¬œ 20 cars: Night Car, Drawers, Carnival, Quarters, Clinic, Market, School, Voting, Archive, Lounge
- â¬œ Disguise system introduction
- â¬œ Political manipulation mechanics
- â¬œ Companion recruitment: Bureaucrat, Teacher

### 4.5 Zone: Working Spine (Cars 50-62) â€” P1
- â¬œ 13 cars: Generators, Water Treatment, HVAC, Comms, Armory, Maintenance Tunnels, Cold Lab, Drawbridge
- â¬œ Infrastructure control (blackouts, water, temperature)
- â¬œ BOSS: Chief Engineer

### 4.6 Zone: First Class (Cars 63-82) â€” P1
- â¬œ 20 cars: Aquarium, Sushi Bar, Sauna, Tailor, Ballroom, Art Gallery, Casino, Opera, Penthouses, Boardroom
- â¬œ Infiltration gameplay (disguises critical)
- â¬œ Companion recruitment: Defector, Entertainer
- â¬œ BOSS: Head of Hospitality

### 4.7 Zone: Sanctum (Cars 83-95) â€” P1
- â¬œ 13 cars: Cathedral, Confession Booth, Eugenics Lab, Cryo Bay, Propaganda Studio, War Room, Experimental Car, Garden of Eden, Vault, Gauntlet
- â¬œ Major plot twist (The Betrayal Car)
- â¬œ Companion recruitment: Ex-Priest, Jackboot Deserter
- â¬œ BOSS: High Priest of the Engine

### 4.8 Zone: Engine (Cars 96-99) â€” P1
- â¬œ 4 cars: Antechamber, Child Labor, Observation Deck, Engine Room
- â¬œ Final confrontation with Wilford
- â¬œ 6 endings implementation
- â¬œ BOSS: Wilford (dialogue + optional combat)

### 4.9 Secret Cars (7-10 total) â€” P2
- â¬œ Bunker Car, Ghost Car, Rebel Archive, Outside Lab, Stowaway Car, Mirror Car, Prototype
- â¬œ Access requirements (faction, items, skill checks)
- â¬œ Unique rewards per secret car
- â¬œ 2 secret cars affect ending availability

---

## PHASE 5: FACTION & QUEST SYSTEM â€” P1

### 5.1 Faction System
- â¬œ **8 factions** â€” Tailies, Third Class Union, Jackboots, Bureaucracy, First Class Elite, Order of the Engine, Kronole Network, The Thaw
- â¬œ **Reputation tracking** â€” per-faction meter, visible in UI
- â¬œ **Reputation consequences** â€” access, prices, dialogue, aggression
- â¬œ **Faction conflicts** â€” mutual exclusivity on some choices
- â¬œ **Faction quests** â€” 5-8 quests per faction

### 5.2 Quest System
- â¬œ **Quest manager** â€” active, completed, failed tracking
- â¬œ **Main quest** â€” 7 zone-spanning narrative arc
- â¬œ **Side quests** â€” 50+ across all zones
- â¬œ **Companion quests** â€” 3-5 per companion (12 companions Ã— 4 avg = ~48)
- â¬œ **Quest objectives** â€” go-to, interact, kill, collect, escort, dialogue
- â¬œ **Quest UI** â€” log, tracking, map markers

### 5.3 Moral Choice System
- â¬œ **20+ major choices** â€” each affects faction rep + companion loyalty + ending path
- â¬œ **Choice consequence tracking** â€” flags in save system
- â¬œ **Compound consequences** â€” late choices reference early ones
- â¬œ **No "right" answers** â€” genuine trade-offs

---

## PHASE 6: UI/HUD â€” P1

- â¬œ **HUD** â€” Health, stamina, cold, hunger, detection, ammo/durability, compass
- â¬œ **Train map** â€” 100-car linear diagram, scrollable, zone colors, fog of war
- â¬œ **Inventory screen** â€” grid + weight, sorting, comparison
- â¬œ **Character screen** â€” stats, skills, perks, equipment
- â¬œ **Quest log** â€” active/completed/failed, tracking toggle
- â¬œ **Faction screen** â€” reputation bars
- â¬œ **Companion screen** â€” loyalty, equipment, personal quest
- â¬œ **Crafting screen** â€” recipes, materials, station requirements
- â¬œ **Codex/journal** â€” lore, collectibles tracker
- â¬œ **Dialogue UI** â€” speaker portrait, text, response options
- â¬œ **Main menu** â€” new game, continue, settings, credits
- â¬œ **Pause menu** â€” resume, save, load, settings, quit
- â¬œ **Death screen** â€” reload checkpoint / quit
- â¬œ **Minimal HUD mode** â€” show only when relevant

---

## PHASE 7: AUDIO & VFX â€” P2

### 7.1 Audio
- â¬œ **Train ambiance** â€” constant wheel rhythm, creaking, wind, engine hum
- â¬œ **Zone ambient layers** â€” Tail (dripping, coughing), First (orchestra, laughter), etc.
- â¬œ **Adaptive music** â€” exploration â†’ suspicion â†’ combat â†’ wind-down
- â¬œ **7 boss fight themes**
- â¬œ **Combat SFX** â€” weapon impacts per type, armor clanks, grunts
- â¬œ **Environmental SFX** â€” doors, pressure seals, hull breach, machinery
- â¬œ **UI SFX** â€” pickup, quest update, level up, menu navigation
- â¬œ **PA system** â€” zone-specific announcements (looping)

### 7.2 VFX
- â¬œ **Steam/smoke** â€” pipes, vents, kitchen areas
- â¬œ **Sparks** â€” electrical systems, combat impacts on metal
- â¬œ **Cold breath** â€” visible in freezer sections
- â¬œ **Blood/damage** â€” hit feedback, floor splatter
- â¬œ **Kronole effects** â€” visual distortion, slow-mo, addiction visual cues
- â¬œ **Weather through windows** â€” blizzard, aurora, clear sky
- â¬œ **Lighting flickers** â€” Tail fluorescent, damaged sections

---

## PHASE 8: POLISH & SYSTEMS â€” P2

### 8.1 Save System
- â¬œ **Per-car state persistence** â€” NPCs, loot, doors, faction control
- â¬œ **3 manual save slots + 1 autosave**
- â¬œ **Autosave triggers** â€” car entry, quest completion, major choice
- â¬œ **Save file versioning** for patch compatibility
- â¬œ **Steam Cloud save**

### 8.2 Difficulty
- â¬œ **4 tiers** â€” Passenger, Survivor, Eternal Engine, Mr. Wilford
- â¬œ **Per-difficulty modifiers** â€” AI aggression, resource scarcity, permadeath
- â¬œ **Adaptive difficulty** â€” optional, based on death count

### 8.3 Accessibility
- â¬œ Full subtitles with speaker ID
- â¬œ Colorblind modes (3 types)
- â¬œ Control remapping
- â¬œ Toggle vs hold for sprint/crouch/aim
- â¬œ Dyslexia-friendly font
- â¬œ HUD size/opacity options

### 8.4 Performance
- â¬œ Car streaming optimization â€” max 3 loaded
- â¬œ LOD system for distant cars
- â¬œ NPC pooling (max 20 per car)
- â¬œ Texture streaming per zone
- â¬œ 60fps target on mid-range hardware

---

## PHASE 9: ENDINGS & NARRATIVE â€” P1

- â¬œ **Ending 1: The New Wilford** â€” Take the Engine, become the tyrant
- â¬œ **Ending 2: The Revolution** â€” Destroy class system, democracy on rails
- â¬œ **Ending 3: The Derailment** â€” Destroy the Engine, everyone faces the cold
- â¬œ **Ending 4: The Exodus** â€” Open the front door, lead survivors out
- â¬œ **Ending 5: The Eternal Loop** â€” Discover truth, choose silence or revelation
- â¬œ **Ending 6 (Secret): The Bridge** â€” Contact another train
- â¬œ **Ending calculator** â€” aggregate choice flags, companion survival, faction alignment
- â¬œ **Ending cinematics** â€” unique cutscene per ending
- â¬œ **Credits variation** â€” music changes per ending

---

## PHASE 10: STEAM & PUBLISHING â€” P2

- â¬œ Steam integration (achievements, cloud saves, rich presence)
- â¬œ 60+ Steam achievements
- â¬œ Store page (description, screenshots, trailer plan)
- â¬œ Content rating (ESRB M / PEGI 18)
- â¬œ Controller support (full gamepad bindings)
- â¬œ Localization prep (English primary, structure for i18n)
- â¬œ Demo build (Cars 0-14, Tail only)
- â¬œ Early Access roadmap (Zones 1-3 for EA, full for 1.0)

---

## PHASE 11: POST-LAUNCH â€” P3

- â¬œ New Game+ (carry skills/recipes, harder enemies, new dialogue)
- â¬œ Roguelike mode (permadeath, randomized car subset)
- â¬œ Photo mode
- â¬œ Mod support (Steam Workshop, custom cars/items)
- â¬œ Daily challenge mode (10-car gauntlet with leaderboard)

---

## CURRENT SPRINT: Phase 3 Core Systems

**Active Polecats:**
| Polecat | Bead | Assignment | Status |
|---------|------|------------|--------|
| rust | hq-bsztm | Player Character Systems | Shell died â€” needs recycle |
| chrome | hq-qnc2b | Combat System | Failed to start â€” needs recycle |
| guzzle | hq-b36xd | UI/HUD | Active |
| nitro | hq-t3h4m | Stealth & NPC AI | Failed to start â€” needs recycle |

**Next beads to create:**
- Dialogue & Quest System
- Inventory & Crafting
- Faction System
- Car Construction Kit (modular level building)
